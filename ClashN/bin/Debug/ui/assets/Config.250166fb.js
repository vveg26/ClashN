var J=Object.defineProperty,q=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var R=(e,a,l)=>a in e?J(e,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[a]=l,u=(e,a)=>{for(var l in a||(a={}))P.call(a,l)&&R(e,l,a[l]);if(C)for(var l of C(a))O.call(a,l)&&R(e,l,a[l]);return e},E=(e,a)=>q(e,F(a));var j=(e,a)=>{var l={};for(var s in e)P.call(e,s)&&a.indexOf(s)<0&&(l[s]=e[s]);if(e!=null&&C)for(var s of C(e))a.indexOf(s)<0&&O.call(e,s)&&(l[s]=e[s]);return l};import{R as d,g as K,r as t,k as W,J as Q,j as X}from"./vendor.ba31f7a6.js";import{r as Y}from"./logs.0ad18268.js";import{S}from"./Select.9719ad7f.js";import{s as A,b as Z,d as T,e as $,u as ee,c as M,h as te,g as B,i as ae,o as ne,j as k,k as le,C as se,l as re,B as oe,n as ce,q as ie}from"./index.5c77d412.js";const{useState:pe,useRef:ue,useEffect:de,useCallback:me}=d;function ge(e){return d.createElement("input",u({className:A.input},e))}function fe(l){var s=l,{value:e}=s,a=j(s,["value"]);const[i,r]=pe(e),m=ue(e);de(()=>{m.current!==e&&r(e),m.current=e},[e]);const g=me(b=>r(b.target.value),[r]);return d.createElement("input",u({className:A.input,value:i,onChange:g},a))}const xe="_root_1tdl3_1",Ee="_section_1tdl3_2",he="_wrapSwitch_1tdl3_26",ve="_sep_1tdl3_32",Ce="_label_1tdl3_45";var c={root:xe,section:Ee,wrapSwitch:he,sep:ve,label:Ce};const be="_fieldset_1ghjp_1",ye="_input_1ghjp_9",Se="_cnt_1ghjp_9";var _={fieldset:be,input:ye,cnt:Se};function ke({OptionComponent:e,optionPropsList:a,selectedIndex:l,onChange:s}){const i=K("visually-hidden",_.input),r=m=>{s(m.target.value)};return d.createElement("fieldset",{className:_.fieldset},a.map((m,g)=>d.createElement("label",{key:g},d.createElement("input",{type:"radio",checked:l===g,name:"selection",value:g,"aria-labelledby":"traffic chart type "+g,onChange:r,className:i}),d.createElement("div",{className:_.cnt},d.createElement(e,u({},m))))))}const _e={legend:{display:!1},scales:{xAxes:[{display:!1}],yAxes:[{display:!1}]}},D=[23e3,35e3,46e3,33e3,9e4,68e3,23e3,45e3],we=[184e3,183e3,196e3,182e3,19e4,186e3,182e3,189e3],Ie=D;function Ne({id:e}){const a=Z.read(),l=t.exports.useMemo(()=>({labels:Ie,datasets:[E(u(u({},T),$[e].up),{data:D}),E(u(u({},T),$[e].down),{data:we})]}),[e]),s="chart-"+e;return ee(a,s,l,null,_e),d.createElement("div",{style:{width:100,padding:5}},d.createElement("canvas",{id:s}))}const{useEffect:U,useState:Le,useCallback:f,useRef:Pe,useMemo:Oe}=X,Re=[{id:0},{id:1},{id:2},{id:3}],je=[["debug","Debug"],["warning","Warning"],["info","Info"],["error","Error"],["silent","Silent"]],Ae=[{key:"port",label:"HTTP Proxy Port"},{key:"socks-port",label:"SOCKS5 Proxy Port"},{key:"mixed-port",label:"Mixed Port"},{key:"redir-port",label:"Redir Port"}],Te=[["zh","\u4E2D\u6587"],["en","English"]],$e=[["Global","Global"],["Rule","Rule"],["Direct","Direct"]],Me=e=>({configs:te(e),apiConfig:B(e)}),Be=e=>({selectedChartStyleIndex:ce(e),latencyTestUrl:ie(e),apiConfig:B(e)}),De=M(Be)(Ve);var Fe=M(Me)(Ue);function Ue({dispatch:e,configs:a,apiConfig:l}){return U(()=>{e(ae(l))},[e,l]),t.exports.createElement(De,{configs:a})}function Ve({dispatch:e,configs:a,selectedChartStyleIndex:l,latencyTestUrl:s,apiConfig:i}){const[r,m]=Le(a),g=Pe(a);U(()=>{g.current!==a&&m(a),g.current=a},[a]);const b=f(()=>{e(ne("apiConfig"))},[e]),x=f((n,o)=>{m(E(u({},r),{[n]:o}))},[r]),V=f(n=>{const o="allow-lan",p=n;x(o,p),e(k(i,{"allow-lan":p}))},[i,e,x]),h=f(({name:n,value:o})=>{switch(n){case"mode":case"log-level":x(n,o),e(k(i,{[n]:o})),n==="log-level"&&Y(E(u({},i),{logLevel:o}));break;case"redir-port":case"socks-port":case"mixed-port":case"port":if(o!==""){const p=parseInt(o,10);if(p<0||p>65535)return}x(n,o);break;default:return}},[i,e,x]),z=f(n=>h(n.target),[h]),{selectChartStyleIndex:G,updateAppConfig:w}=le(),I=f(n=>{const o=n.target,{name:p,value:L}=o;switch(p){case"port":case"socks-port":case"mixed-port":case"redir-port":{const y=parseInt(L,10);if(y<0||y>65535)return;e(k(i,{[p]:y}));break}case"latencyTestUrl":{w(p,L);break}default:throw new Error(`unknown input name ${p}`)}},[i,e,w]),H=Oe(()=>{const n=r.mode;return typeof n=="string"&&n[0].toUpperCase()+n.slice(1)},[r.mode]),{t:v,i18n:N}=W();return t.exports.createElement("div",null,t.exports.createElement(se,{title:v("Config")}),t.exports.createElement("div",{className:c.root},Ae.map(n=>r[n.key]!==void 0?t.exports.createElement("div",{key:n.key},t.exports.createElement("div",{className:c.label},n.label),t.exports.createElement(ge,{name:n.key,value:r[n.key],onChange:z,onBlur:I})):null),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Mode"),t.exports.createElement(S,{options:$e,selected:H,onChange:n=>h({name:"mode",value:n.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Log Level"),t.exports.createElement(S,{options:je,selected:r["log-level"],onChange:n=>h({name:"log-level",value:n.target.value})})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Allow LAN"),t.exports.createElement("div",{className:c.wrapSwitch},t.exports.createElement(re,{name:"allow-lan",checked:r["allow-lan"],onChange:V})))),t.exports.createElement("div",{className:c.sep},t.exports.createElement("div",null)),t.exports.createElement("div",{className:c.section},t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},v("latency_test_url")),t.exports.createElement(fe,{name:"latencyTestUrl",type:"text",value:s,onBlur:I})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},v("lang")),t.exports.createElement("div",null,t.exports.createElement(S,{options:Te,selected:N.language,onChange:n=>N.changeLanguage(n.target.value)}))),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},v("chart_style")),t.exports.createElement(ke,{OptionComponent:Ne,optionPropsList:Re,selectedIndex:l,onChange:G})),t.exports.createElement("div",null,t.exports.createElement("div",{className:c.label},"Action"),t.exports.createElement(oe,{start:t.exports.createElement(Q,{size:16}),label:"Switch backend",onClick:b}))))}export{Fe as default};
